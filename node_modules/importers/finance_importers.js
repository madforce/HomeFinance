var fs = require('fs'),
    util = require('util'),
    events = require('events');

function importers () {
    this.version = 'importers version 0.0.1';
    var self = this;
    this.loadModules = function() {
        loadModules(function () {
            self.emit('ready');
        })
    }
    /*

    */
}

function loadModules(callback)
{
    fs.readdir('./node_modules/importers/parsers', function (err, files) {
        if (typeof err != 'undefined') {
            for (file in files) {
                console.log(file + " => " + files[file]);
                var parser = 'var ' + files[file].toString().replace('.js', '') + ' = require(\'./parsers/' + files[file] + '\');'
                console.log(parser);
                eval (parser);
                var reg = 'importers.prototype.' + files[file].toString().replace('.js', '') + ' = ' + files[file].toString().replace('.js', '');
                console.log(reg);
                eval (reg)
            }
            
            callback();
        }
    });
}

util.inherits(importers, events.EventEmitter);
importers.prototype.blah = function () {
    console.log('me me');    
}
module.exports = new importers();

//var OFX = require('./OFX.js');



